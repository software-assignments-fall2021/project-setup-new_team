import axios from 'axios';
import React from 'react'
import './Registration.css'




const Registration = (props) => {
  const [registrationMessage, setRegistrationMessage] = React.useState('');
  const [redirect, setRedirect] = React.useState(false);
  const handleSubmit = (event) => {
    event.preventDefault();
    //send data to server
    axios.post('http://localhost:3000/register', {
      username: event.target.username.value,
      email: event.target.email.value,
      password: event.target.password.value,
      confirm_password: event.target.confirm_password.value
    })
    .then(function (response) {
      //give success message
      console.log(response);
      if(response.data.success){
        setRegistrationMessage("Success! You will be redirected shortly.")
        setRedirect(true)
      }else{
        setRegistrationMessage(response.data.status);
      }
    })
    .catch(function (error) {
      //give error message
      console.log(error);
      setRegistrationMessage(error.response.data.error)
    });
  }
  return (
    <div>
        {/* gives user registration fields: username, password, confirm password, email*/}
        <div className="register-container">
            <div className="register-form">
                <div className="register-header font-size">
                    Register
                </div>
                {/* form to post data to back-end when submitted */}
                <form action="http://localhost:3000/register" method="POST" onSubmit={handleSubmit}>
                    <input type="text" placeholder="Username" name="username" required/>
                    <input type="email" placeholder="Email" name="email" required/>
                    <input type="password" placeholder="Password" name="password" required/>
                    <input type="password" placeholder="Confirm Password" name="confirm_password" required/>
                    <input type="submit" value="Register" className="register-button"/>
               </form> 
               {/*
              <button onClick={handle_register} > Register </button> */}
              <p>{registrationMessage}</p>
              </div>
              {redirect ? <meta http-equiv="refresh" content={`0; url=/login`} />: null}
        </div>
    </div>

  )
}

export default Registration